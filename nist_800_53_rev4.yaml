# This profile maps applicable parameters to NIST 800-53 Rev 4
# auditd module
compliance::nist_800_53_rev4::auditd::root_audit_level :
  'identifier' : ['AC-6(9)','AU-2(a)','AU-2(b)','AU-2(c)','AU-2(d)','AU-2(4)','AU-12(a)','AU-12(c)']
  'value' : 'basic'
compliance::nist_800_53_rev4::auditd::at_boot :
  'identifier' : ['AU-14(1)','AU-1(b)','AU-2(a)','AU-2(c)','AU-2(d)','AU-10']
  'value' : true
compliance::nist_800_53_rev4::auditd::to_syslog :
  'identifier' :  ['AU-3(2)','AU-4(1)','AU-9']
  'value' : true
compliance::nist_800_53_rev4::auditd::package_name :
  'identifier' : ['AU-3','AU-8(b)','AU-12(a)','AU-12(b)','AU-12(c)','AU-12(2)']
  'value' : 'audit'
compliance::nist_800_53_rev4::auditd::service_name::enabled :
  'identifier' : ['AU-8(b)','AU-12(a)','AU-12(b)','AU-12(c)','AU-12(2)']
  'value'      : true
compliance::nist_800_53_rev4::auditd::enable_auditing :
  'identifier' : ['AU-8(b)','AU-12(a)','AU-12(b)','AU-12(c)','AU-12(2)']
  'value' : true
compliance::nist_800_53_rev4::auditd::num_logs :
  'identifier' : ['AU-4','AU-11']
  'value' : '5'
  'notes' : 'This value can be different than 5 but should be justified.'
compliance::nist_800_53_rev4::auditd::max_log_file :
  'identifier' : ['AU-4','AU-11']
  'value' : '24'
  'notes' : 'This value can be different than 24 but should be justified.'
compliance::nist_800_53_rev4::auditd::space_left_action :
  'identifier' : ['AU-4','AU-5(a)','AU-11']
  'value' : 'SYSLOG'
  'notes' : 'This value can be changed if there is a more ideal notification method for your systems'
compliance::nist_800_53_rev4::auditd::admin_space_left :
  'identifier' : ['AU-4','AU-5(b)','AU-11']
  'value' : '50'
compliance::nist_800_53_rev4::auditd::admin_space_left_action :
  'identifier' : ['AU-4','AU-5(b)','AU-11']
  'value' : 'SUSPEND'
compliance::nist_800_53_rev4::auditd::disk_full_action :
  'identifier' : ['AU-4','AU-5(b)','AU-11']
  'value' : 'SUSPEND'
compliance::nist_800_53_rev4::auditd::disk_error_action :
  'identifier' : ['AU-4','AU-5(b)','AU-11']
  'value' : 'SUSPEND'
compliance::nist_800_53_rev4::auditd::admin_space_left_action :
  'identifier' : ['AU-4','AU-5(b)','AU-11']
  'value' : 'SUSPEND'
# For now just check that the simp profile is applied
compliance::nist_800_53_rev4::auditd::default_audit_profile :
  'identifier' : ['AU-2(a)','AU-2(c)','AU-2(d)','AC-6(9)','AU-12(a)','AU-12(c)']
  'value' : 'simp'
  'notes' : 'The SIMP profile applies a base set of audit rules that adhere to guidance from several sources'
compliance::nist_800_53_rev4::auditd::failure_mode :
  'identifier' : 'AU-5(b)'
  'value' : '2'

#ClamAV
compliance::nist_800_53_rev4::clamav::enable_clamav:
  'identifier' : ['SI-3(a)']
  'value' : true
  'notes' : 'If ClamAV is not used, alternate malicious code detection software should be implemented'
compliance::nist_800_53_rev4::clamav::package_name:
  'identifier' : ['SI-3(a)']
  'value' : true
  'notes' : 'If ClamAV is not used, alternate malicious code detection software should be implemented'
# Not sure if we should fail this one since freshclam requires full network access from all the clients.
# Should we use rsync instead
compliance::nist_800_53_rev4::clamav::enable_freshclam:
  'identifier' : ['SI-3(b)']
  'value' : true
  'notes' : 'If ClamAV is not used, alternate malicious code detection software should be implemented'
compliance::nist_800_53_rev4::clamav::schedule_scan:
  'identifier' : ['SI-3(b)']
  'value' : true
  'notes' : 'If ClamAV is not used, alternate malicious code detection software should be implemented'

# simp module
compliance::nist_800_53_rev4::simp::security_profile:
  'identifier' : 'SI-3(b)'
# TODO - Come back and figure what the heck this means, and then map it
  'value' : 'simp'
compliance::nist_800_53_rev4::simp::enable_filebucketing:
  'identifier' : ['SI-3(b)']
# TODO - Come back and figure what the heck this means, and then map it
  'value' : true
compliance::nist_800_53_rev4::simp::admin::passwordless_admin_sudo:
  'identifier' : 'IA-1(a)'
  'value' : true
  'notes' : 'Passwordless sudo for the administrators group is part of a larger default account managment strategy in SIMP.  Setting this to false might not mean be a bad thing as long as the implementation can explain their account strategy'
compliance::nist_800_53_rev4::simp::admin::passwordless_auditor_sudo:
  'identifier' : 'IA-1(a)'
  'value' : true
  'notes' : 'Passwordless sudo for the security group is part of a larger default account managment strategy in SIMP.  Setting this to false might not mean be a bad thing as long as the implementation can explain their account strategy'
compliance::nist_800_53_rev4::simp::admin::force_sudosh:
  'identifier' : 'AC-6(9)'
  'value' : true
# TODO This one probably exists somewhere else.  Check this before committing. 
compliance::nist_800_53_rev4::simp::kickstart_server::use_fip:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : true
compliance::nist_800_53_rev4::simp::puppetdb::client_nets:
#TODO Controls start here
  'identifier' : ['AC-4',
  'value' : '127.0.0.1'
  'notes : "The only time this value should be changed is if there are multiple puppet masters' 
compliance::nist_800_53_rev4::simp::puppetdb::disable_ssl:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : 'false'
compliance::nist_800_53_rev4::simp::server::allow_simp_user:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : true
compliance::nist_800_53_rev4::simp::server:enable_rsync_shares:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : true
compliance::nist_800_53_rev4::simp::yum::enable_auto_updates:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : true
  'notes' : 'For this control to be fully applied, updated pacakges need to be applied to the configured yum repos'     
compliance::nist_800_53_rev4::simp::nfs::sec:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : 'none:sys'
compliance::nist_800_53_rev4::simp::rsyslog::stock::security_relevant_logs:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : "if \$programname == 'sudosh' or \$programname == 'yum' or \$syslogfacility-text == 'cron' or \$syslogfacility-text == 'authpriv' or \$syslogfacility-text == 'local5' or \$syslogfacility-text == 'local6' or \$syslogfacility-text == 'local7' or \$syslogpriority-text == 'emerg' or ( \$syslogfacility-text == 'kern' and \$msg startswith 'IPT:' ) then"
  'notes' : 'If the default security relevant logs are changed, they should be justified, espeially if fewer than the SIMP default are configured'
compliance::nist_800_53_rev4::simp::rsyslog::stock::security_relevant_logs:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : "if \$programname == 'sudosh' or \$programname == 'yum' or \$syslogfacility-text == 'cron' or \$syslogfacility-text == 'authpriv' or \$syslogfacility-text == 'local5' or \$syslogfacility-text == 'local6' or \$syslogfacility-text == 'local7' or \$syslogpriority-text == 'emerg' or ( \$syslogfacility-text == 'kern' and \$msg startswith 'IPT:' ) then"
  'notes' : 'If the default security relevant logs are changed, they should be justified, espeially if fewer than the SIMP default are configured'
compliance::nist_800_53_rev4::simp::rsyslog::stock::log_server::rotate_period:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : 'weekly'
  'notes' : 'This value can vary according to storage capacity of a log server'
compliance::nist_800_53_rev4::simp::rsyslog::stock::log_server::rotate:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : '12'
  'notes' : 'This value can vary according to storage capacity of a log server'
compliance::nist_800_53_rev4::simp::rsyslog::stock::log_server::size:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : ''
  'notes' : 'This value can vary according to storage capacity of a log server'
compliance::nist_800_53_rev4::simp::rsyslog::stock::log_server::use_iptables:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : true
compliance::nist_800_53_rev4::simp::rsyslog::stock::log_server::forward::log_transport:
  'identifier' : ['SC-8', 'SC-8(1)','SC-8(2)','SC-13','SC-23']
  'value' : 'tcp'
  'notes' : 'This use of UDP should be justified'

